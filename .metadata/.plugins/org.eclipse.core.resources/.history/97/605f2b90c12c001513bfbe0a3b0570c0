package games;

import java.awt.Point;
import java.util.ArrayList;
import java.util.Random;

/**
 * 
 * GameObjects Create tetris bricks and game board.
 *
 */

public class BlockObject {
	private static final int AMOUNT_OF_BLOCKS = 6;
	private static final int ROTATE_AMOUNT = 3;

	private static final int BLOCK_WIDTH = 4;
	private static final int BLOCK_HEIGHT = 4;

	private static final int BLOCK_POS_X = 175;
	private static final int BLOCK_POS_Y = 50;
	private static final int BLOCK_SIZE = 25;
	
	private int[] blockIndex;
	//private int BLOCK_WIDTH;
	//private int BLOCK_HEIGHT;
	private int posX;
	private int posY;
	//private int BLOCK_SIZE;

	private int outlineX;
	private int outlineY;
	private int outlineWidth;
	private int outlineHeight;

	private ArrayList<Point> blockPos;

	public GameObject() {
	};

	private int blockType;
	private int blockRotate;
	
	public GameObject(int[] blockIndex, int BLOCK_WIDTH, int BLOCK_HEIGHT,
			int size) {

		// initiate object
		this.setObject(blockIndex, BLOCK_WIDTH, BLOCK_HEIGHT, size);
	}
	//public void setObject() {
	////	blockIndex = GameBlocks.getBlock(blockType, blockRotate);
	//}
	/*
	public void setBlockDimensions(int BLOCK_WIDTH, int BLOCK_HEIGHT,int size) {
		
		this.BLOCK_WIDTH = BLOCK_WIDTH;
		this.BLOCK_HEIGHT = BLOCK_HEIGHT;
		blockPos = new ArrayList<>();

		this.setObject();
		BLOCK_SIZE = size;

	}
	*/
	/*
	public void setObject(int[] blockIndex) {
		this.blockIndex = blockIndex;
	}
*/
	public void setNextBlock() {
		Random randomizer = new Random();
		this.blockType = randomizer.nextInt(AMOUNT_OF_BLOCKS + 1);
		this.blockRotate = 0;
	}
	public void setObject(int[] blockIndex, int BLOCK_WIDTH, int BLOCK_HEIGHT,
			int size) {

		// set all values
	//	this.BLOCK_WIDTH = BLOCK_WIDTH;
	//	this.BLOCK_HEIGHT = BLOCK_HEIGHT;
		posX = 0;
		posY = 0;
		//BLOCK_SIZE = size;
		blockPos = new ArrayList<>();
		this.blockIndex = blockIndex;
		//setObject(blockIndex);
	}
	public void setBlockRotate(int blockRotate) {
		this.blockRotate = blockRotate;
	}
	public void rotateBlock(int blockRotate) {
		this.blockRotate = blockRotate;
	}
	public void setBlockType(int blockType) {
		this.blockType = blockType;
	}
	public int getBlockType() {
		return blockType;
	}
	
//	public void setHorBlockAmnt(int BLOCK_WIDTH) {
	//	this.BLOCK_WIDTH = BLOCK_WIDTH;
	//}
	//public void setVerBlockAmnt(int BLOCK_HEIGHT) {
	//	this.BLOCK_HEIGHT = BLOCK_HEIGHT;
	//}

	public void setOutline() {
		outlineX = posX;
		outlineY = posY;
		outlineWidth = BLOCK_SIZE * BLOCK_WIDTH;
		outlineHeight = BLOCK_SIZE * BLOCK_HEIGHT;

	}

	public void setBlockPos() {
		int locate_X = posX;
		int locate_Y = posY;
		int index = 0;
		blockPos.clear();

		for (int y = 0; y < BLOCK_HEIGHT; y++) {
			for (int x = 0; x < BLOCK_WIDTH; x++) {

				// add new block position
				if (blockIndex[index] > 0)
					blockPos.add(new Point(locate_X, locate_Y));

				locate_X += BLOCK_SIZE;
				index++;
			}
			locate_X = posX;
			locate_Y += BLOCK_SIZE;
		}
	}

	public int getBlockPosSize() {
		return blockPos.size();
	}

	public int getBlockPosX(int index) {
		return blockPos.get(index).x;
	}

	public int getBlockPosY(int index) {
		return blockPos.get(index).y;
	}

	public int getBlockIndexValue() {
		for (int i = 0; i < blockIndex.length; i++)
			if (blockIndex[i] > 0)
				return blockIndex[i];
		return 0;
	}

	public ArrayList<Point> getBlockPos() {
		return blockPos;
	}

	public Point getBlockPos(int index) {
		return blockPos.get(index);
	}

	public int getBlockIndex(int num) {
		return blockIndex[num];
	}

	public void dropBlock() {
		int size = blockIndex.length;
		int count = size - 1;
		int[] newBlocks = new int[size];

		for (int i = size - 1; i >= 0; i--) {

			// pull tetris brick down one row at a time
			if (blockIndex[i] >= 0) {
				newBlocks[count] = blockIndex[i];
				count--;
			}
		}

		blockIndex = newBlocks;
		this.setBlockPos();
	}

	public boolean hasObject(GameObject gameObject) {

		for (int i = 0; i < gameObject.getBlockPosSize(); i++) {

			// if tetris pieces do not overlapped other pieces
			if (blockPos.contains(gameObject.getBlockPos(i)))
				return true;
		}

		return false;
	}

	public void addObject(GameObject gameObject) {
		int index = 0;
		int locate_X = posX;
		int locate_Y = posY;
		boolean value = false;
		//int BLOCK_SIZE = gameObject.getBlockSize();

		for (int y = 0; y < BLOCK_HEIGHT; y++) {
			for (int x = 0; x < BLOCK_WIDTH; x++) {

				// if tetris pieces do not overlapped other pieces
				value = gameObject.blockPos.contains(new Point(locate_X,
						locate_Y));

				// add tetris pieces to board
				if (value)
					blockIndex[index] = gameObject.getBlockIndexValue();

				locate_X += BLOCK_SIZE;
				index++;
			}
			locate_X = posX;
			locate_Y += BLOCK_SIZE;
		}
		// update block position
		setBlockPos();

	}

	public int getFullRow() {
		int index = blockIndex.length - 1;
		int count = 0;

		for (int y = BLOCK_HEIGHT; y > 0; y--) {
			for (int x = BLOCK_WIDTH; x > 0; x--) {

				// count brick pieces that are in a row
				if (blockIndex[index] > 0)
					count++;

				index--;
			}

			// if brick pieces equal block amount then return row number
			if (count == BLOCK_WIDTH)
				return y;
			count = 0;

		}
		return -1;
	}

	public boolean isRowFull() {

		boolean bFlag = false;

		// if tetris brick pieces are in a row
		if (getFullRow() > 0)
			bFlag = true;

		return bFlag;
	}

	public void invertRow() {

		int row = getFullRow();
		int index = blockIndex.length - 1;

		for (int y = BLOCK_HEIGHT; y > 0; y--) {
			for (int x = BLOCK_WIDTH; x > 0; x--) {

				// invert row of tetris brick pieces
				if (row == y)
					blockIndex[index] = blockIndex[index] * -1;

				index--;
			}
		}
	}

	public boolean inBound(GameObject gameObject) {
		int locate_X = 0;
		int locate_Y = 0;
		int BLOCK_WIDTH = outlineX + outlineWidth;
		int BLOCK_HEIGHT = outlineY + outlineHeight;

		for (int i = 0; i < gameObject.getBlockPosSize(); i++) {
			locate_X = gameObject.getBlockPosX(i);
			locate_Y = gameObject.getBlockPosY(i);

			// if tetris brick is in bound
			if (locate_X < outlineX || locate_X >= BLOCK_WIDTH
					|| locate_Y >= BLOCK_HEIGHT)
				return false;
		}
		return true;
	}

	public void setPosition(int posX, int posY) {
		this.posX = posX;
		this.posY = posY;
		this.setBlockPos();
		this.setOutline();
	}

	public void setPosX(int posX) {
		this.posX = posX;
	}

	public int getPosX() {
		return posX;
	}

	public void setPosY(int posY) {
		this.posY = posY;
	}

	public int getPosY() {
		return posY;
	}

	//public int getHorBlockAmnt() {
	//	return BLOCK_WIDTH;
	//}

	//public int getVerBlockAmnt() {
	//	return BLOCK_HEIGHT;
	//}

	public int getOutlineX() {
		return outlineX;
	}

	public int getOutlineY() {
		return outlineY;
	}

	public int getOutlineWidth() {
		return outlineWidth;
	}

	public int getOutlineHeight() {
		return outlineHeight;
	}

	//public int getBlockSize() {
	//	return BLOCK_SIZE;
	//}

	//public void setBlockSize(int BLOCK_SIZE) {
	//	this.BLOCK_SIZE = BLOCK_SIZE;
	//}

	public String toString() {
		return blockPos.toString();
	}

}
